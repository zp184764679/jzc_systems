# 📋 OCR字段支持清单

## ✅ 系统已完整支持的字段（13个核心字段）

### 1️⃣ 基本信息（5个）
| 序号 | 字段名 | 中文名称 | 数据库 | OCR提示词 | API映射 | 前端显示 | 自动填充 |
|------|--------|----------|--------|-----------|---------|----------|----------|
| 1 | `drawing_number` | 图号 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 2 | `customer_name` | 客户名称 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 3 | `product_name` | 产品名称 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 4 | `customer_part_number` | 客户料号 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 5 | `material` | 材质 | ✅ | ✅ | ✅ | ✅ | ✅ |

### 2️⃣ 尺寸信息（3个）
| 序号 | 字段名 | 中文名称 | 数据库 | OCR提示词 | API映射 | 前端显示 | 自动填充 | 数据转换 |
|------|--------|----------|--------|-----------|---------|----------|----------|----------|
| 6 | `outer_diameter` | 外径 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ parseNumericValue |
| 7 | `length` | 长度 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ parseNumericValue |
| 8 | `weight` | 重量 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ parseNumericValue |

### 3️⃣ 技术要求（5个）
| 序号 | 字段名 | 中文名称 | 数据库 | OCR提示词 | API映射 | 前端显示 | 自动填充 |
|------|--------|----------|--------|-----------|---------|----------|----------|
| 9 | `tolerance` | 公差等级 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 10 | `surface_roughness` | 表面粗糙度 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 11 | `heat_treatment` | 热处理 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 12 | `surface_treatment` | 表面处理 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 13 | `special_requirements` | 特殊要求 | ✅ | ✅ | ✅ | ✅ | ✅ |

---

## 🔧 附加字段（系统扩展）

| 字段名 | 中文名称 | 数据库 | 前端显示 | 说明 |
|--------|----------|--------|----------|------|
| `material_spec` | 材质规格 | ✅ | ❌ | 数据库有，但前端未显示 |
| `notes` | 备注 | ✅ | ✅ | 前端有输入框 |
| `lot_size` | 批量 | ❌ | ✅ | 仅前端，用于报价计算 |
| `delivery_days` | 交期 | ❌ | ✅ | 仅前端，用于报价计算 |
| `urgency_level` | 加急程度 | ❌ | ✅ | 仅前端，用于报价计算 |

---

## 📝 关于edocr2的39个字符

**重要说明：** edocr2能识别的**39个字符**不是指39个数据字段，而是指其GD&T（几何尺寸和公差）符号识别的字符表：

### GD&T Alphabet（39个字符）
```python
# 组成：
- 数字: 0-9 (10个)
- 基本符号: ',.⌀ABCD' (7个)
- GD&T符号: '⏤⏥○⌭⌒⌓⏊∠⫽⌯⌖◎↗⌰' (14个)
- FCF符号: 'ⒺⒻⓁⓂⓅⓈⓉⓊ' (8个)
# 总计: 10+7+14+8 = 39个字符
```

### Dimensions Alphabet（38个字符）
```python
# 组成：
- 数字: 0-9 (10个)
- 字母: 'AaBCDRGHhMmnxtd' (15个)
- 特殊符号: '(),.+-±:/°"⌀=' (13个)
# 总计: 10+15+13 = 38个字符
```

这些字符用于识别工程图纸中的专业标注，如：
- 直径符号：⌀、Φ
- 公差符号：±
- 几何公差符号：⏤、⏥、○等
- 表面粗糙度符号：Ra、Rz等

---

## 🎯 系统功能总结

### ✅ 已完成
1. **数据库模型**：包含所有13个核心字段
2. **OCR提示词**：升级后可识别所有13个字段
3. **API字段映射**：完整映射所有字段到数据库
4. **前端显示**：所有字段都有对应的输入框
5. **自动填充**：OCR识别后自动填充所有字段
6. **数据转换**：数字字段自动去除非数字字符（Φ、mm等）

### 📊 识别示例

根据您提供的技术要求，系统预期可以识别到：

```json
{
  "drawing_number": "CPN01802",
  "customer_name": "永州雅力德科技有限公司",
  "product_name": "捻钞辊轴",
  "customer_part_number": "8001-0003095",
  "material": "SUS303",
  "outer_diameter": "7.8",
  "length": "240.4",
  "weight": "",
  "tolerance": "GB/T1804-f级",
  "surface_roughness": "Ra3.2",
  "heat_treatment": "",
  "surface_treatment": "",
  "special_requirements": "1、材质：SUS303；\n2、外观平滑，不得有毛刺、锐边；\n3、未注倒角为C0.5；\n4、未注圆角为R0.2;\n5、未注切口粗糙度按Ra3.2；\n6、未注尺寸公差按GB/T1804-f级；\n7、未注形位公差按GB/T 1184-1996中H级处理;\n8、以Ø2.5中心孔为基准做全跳动检测\n9、符合欧盟ROHS"
}
```

---

## 🔄 测试建议

### 方案1：重新上传图纸
1. 访问：http://localhost:8000/drawings/upload
2. 上传PDF：`8001-0003095捻钞辊轴CPN01802-不锈钢材质.pdf`
3. 自动OCR识别
4. 查看所有字段是否正确填充

### 方案2：API测试
```bash
# 手动触发图纸ID=1的重新识别
curl -X POST http://localhost:8001/api/drawings/1/ocr
```

---

## 📂 相关文件

| 类型 | 文件路径 | 说明 |
|------|----------|------|
| 数据库模型 | `backend/models/drawing.py` | Drawing表结构定义 |
| OCR服务 | `backend/services/drawing_ocr_service.py` | OCR识别提示词和逻辑 |
| API映射 | `backend/api/drawings.py` | OCR结果到数据库的字段映射 |
| 前端页面 | `frontend/src/pages/QuoteCreate.jsx` | 报价创建页面和字段显示 |
| 字段转换 | `frontend/src/pages/QuoteCreate.jsx:59-79` | parseNumericValue函数 |

---

**最后更新时间：** 2025-11-14
**系统版本：** v2.0
**字段数量：** 13个核心字段完整支持
